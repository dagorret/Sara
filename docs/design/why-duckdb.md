## ⚙️ Design decision: Why DuckDB

SARA uses **DuckDB** as its embedded analytical engine.  
This section explains the rationale behind this decision.

---

### Problem to solve

SARA requires an analytical engine that:

- works efficiently with datasets ranging from thousands to millions of rows,
- does not require loading the full dataset into memory,
- supports statistical aggregation and data transformations,
- enables reproducible and auditable workflows,
- runs identically in desktop and web environments,
- is easy to justify in an academic and institutional context.

No single traditional tool (pandas, SQLite, PostgreSQL) satisfies all these requirements simultaneously.

---

### Why DuckDB fits SARA

#### 1. Analytical database (OLAP-oriented)

DuckDB is designed for analytical workloads:
- aggregations (`AVG`, `COUNT`, `STDDEV`, `quantile_cont`)
- filtering and grouping
- column-oriented processing

This matches the core needs of statistics and econometrics, which are fundamentally analytical rather than transactional.

---

#### 2. Direct querying of Parquet files

DuckDB can query Parquet files directly, without importing data into a database:

```sql
SELECT AVG(income)
FROM read_parquet('data.parquet')
WHERE age >= 18;
```

### 2. Direct querying of Parquet files

DuckDB can query Parquet files directly, without importing data into a database.

This means:

- no data duplication,
- no ingestion step,
- Parquet files remain the single source of truth.

---

### 3. Low memory footprint

DuckDB:

- reads only the required columns,
- processes data in chunks,
- avoids loading full datasets into RAM.

This enables SARA to:

- run on standard laptops,
- operate in university labs,
- scale reasonably in web deployments.

By contrast, pandas requires loading full DataFrames into memory.

---

### 4. Embedded and serverless

DuckDB is an embedded library, not a separate service.

Advantages:

- no server setup,
- no configuration overhead,
- same codebase for desktop and web versions.

This is critical for academic environments where infrastructure must remain simple.

---

### 5. SQL as a transparent, teachable language

SQL is:

- widely known by students and instructors,
- easy to inspect and audit,
- suitable for documenting analytical steps.

Queries generated by SARA can be:

- logged,
- displayed,
- explained in teaching contexts.

This directly supports SARA’s pedagogical goals.

---

## Why not pandas?

Pandas is excellent for interactive analysis, but not suitable as SARA’s core engine:

| pandas limitation        | Impact on SARA            |
|--------------------------|---------------------------|
| In-memory DataFrames     | Poor scalability          |
| Mutable state            | Weak reproducibility      |
| No native SQL            | Harder to audit           |
| No dataset versioning    | Conceptual risk           |

In SARA, pandas is limited to:

- small previews,
- optional UI convenience layers.

---

## Why not SQLite?

SQLite is:

- transactional (OLTP-oriented),
- not optimized for analytical aggregation,
- unable to query Parquet files directly.

SQLite is therefore unsuitable for analytical workloads and is not used for data processing in SARA.

---

## Why not PostgreSQL?

PostgreSQL is robust and powerful, but:

- requires a running server,
- would duplicate large datasets,
- is not suitable for lightweight desktop deployments.

In SARA, PostgreSQL is used **only for metadata**, not for analytical computation.

---

## Why not Spark or cloud data warehouses?

Technologies such as Spark, BigQuery, or Snowflake:

- introduce unnecessary infrastructure complexity,
- exceed typical academic and professional data scales,
- are not aligned with SARA’s target use cases.

SARA does not aim to solve extreme big data problems (hundreds of millions of rows).

---

## Academic justification

DuckDB is a well-established research project:

- peer-reviewed academic publication,
- active development and maintenance,
- growing adoption in research and industry.

**Reference:**

> Raasveldt, M., & Mühleisen, H. (2019).  
> *DuckDB: an Embeddable Analytical Database.*  
> arXiv:1909.08833

This makes DuckDB suitable for institutional and academic adoption.

---

## Conclusion

DuckDB is used in SARA because it:

- enables efficient statistical analysis without full in-memory loading,
- operates directly on Parquet datasets,
- supports reproducible and auditable workflows,
- runs seamlessly in both desktop and web environments,
- relies on transparent and standard SQL.

DuckDB is not a convenience choice — it is the correct tool for SARA’s analytical requirements.
